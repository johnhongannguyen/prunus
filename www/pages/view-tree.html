<!-- SINGLE-FILE-COMPONENT -->
<!-- https://framework7.io/docs/router-component.html#single-file-component -->

<template>
    <div class="page" data-name="view-tree">

        <!-- Scrollable PAGE CONTENT-->
        <div class="page-content">

            <div id='container'>
                <div id="group1">

                    <div class="background">
                        <img id="img-tree" src="{{tree.img_url}}" alt="Tree picture">
                    </div>

                    <div class="foreground user-reaction elevation-12">
                        <!-- RATING -->
                        <div class="field">
                            <div class="flex-box">
                                <label class="radio"><input disabled type="radio" name="emotion" value="1" {{checkRating(1)}}><i class="icon-radio"></i>Happy</label>
                                <label class="radio"><input disabled type="radio" name="emotion" value="2" {{checkRating(2)}}><i class="icon-radio"></i>Amazed</label>
                                <label class="radio"><input disabled type="radio" name="emotion" value="3" {{checkRating(3)}}><i class="icon-radio"></i>Stunned</label>
                            </div>
                        </div>


                        <!-- STATUS -->
                        <div class="field">
                            <div class="flex-box">
                                <span>Growing</span>
                                <span>Blossoming</span>
                                <span>Fully Bloomed</span>
                            </div>

                            <!-- Value is being set programmatically -->
                            <div class="item-input-wrap">
                                <div id="slider-view-tree" class="range-slider range-slider-init" data-label="true">
                                    <input type="range" min="0" max="2" step="1">
                                </div>
                            </div>
                        </div>


                        <!-- LOCATION -->
                        <div class="field">
                            <h2>Location info</h2>
                            <div class="flex-box">
                                <span>Latitude: <span id="lat">{{tree.lat}}</span></span>
                                <span>Longitude: <span id="lng">{{tree.lng}}</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>

</template>
<!-- component styles -->
<style>

    .user-reaction {
        padding: 1rem;
        background: #eee;

        /* TODO - remove this */
        padding-bottom: 200px;
    }


    /* Spacing between each row: */
    .field {
        margin-bottom: 3rem;
    }

    /* centering radio buttons: */
    .field .radio i {
        margin:auto;
    }

    .flex-box {
        display: flex;
        justify-content: space-between
    }

    @media screen and (min-width:900px) {
        .foreground {
            top: 80vh;
        }

        .background img {
            max-height:80vh;
        }
    }

</style>
<!-- rest of component data and methods -->
<script>
    // script must return component object
    return {

        data: function () {
            return {

                //This tree object will be filled after the firebase request:
                tree: new Tree(),

                checkRating: function(v){

                    return (v == this.tree.rating) ? "checked" : ""
                }
            }
        },

        on: {
            pageInit: function () {
                // do something on page init
                var self = this;
                console.log('view-tree initialized');


                //Getting the ID for the tree from the router.
                var id = mainView.router.currentRoute.context.key;


                treeCRUD.read(id, function(result) {
                    self.tree = result;    //Updating tree object
                    self.$setState();      //Forcing the view to reset

                    //Setting the value to the slider:
                    app.range.get('.range-slider').setValue(self.tree.blooming);

                    app.range.get('.range-slider').params.draggableBar = false;
                })

            },
            pageAfterOut: function () {
                // page has left the view
            },
        }
    }
</script>
